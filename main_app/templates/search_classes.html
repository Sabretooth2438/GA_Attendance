{% extends 'base.html' %}

{% block title %}
    Search Classes | GA Attendance
{% endblock %}

{% block content %}
    <h2>Search Classes</h2>
    <form method="post" class="search-form">
        {% csrf_token %}
        <input type="text" name="query" placeholder="Search classes" value="{{ query }}" class="search-input" />
        <button type="submit" class="btn">Search</button>
    </form>

    <ul class="class-list">
        {% if classes %}
            {% for class in classes %}
                <li class="class-item">
                    <a href="{% url 'class_detail' pk=class.pk %}" class="class-link">{{ class.name }}</a>
                    <form method="post" action="{% url 'send_join_request' pk=class.pk %}" class="join-form">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-join"
                            {% if class in joined_classes %}disabled{% endif %}
                            {% if class.id in pending_requests %}disabled{% endif %}>
                            {% if class in joined_classes %}Already Joined{% elif class.id in pending_requests %}Request Pending{% else %}Join{% endif %}
                        </button>
                    </form>
                </li>
            {% endfor %}
        {% else %}
            <p class="no-classes">No classes available.</p>
        {% endif %}
    </ul>
{% endblock %}
