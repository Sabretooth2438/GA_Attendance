{% extends 'base.html' %}

{% block title %}
    Add Student | GA Attendance
{% endblock %}

{% block content %}
<h2>Add Student to {{ class.name }}</h2>
<form method="post" class="search-form">
    {% csrf_token %}
    <input type="text" name="query" placeholder="Search students" value="{{ query }}" class="search-input">
    <button type="submit" class="btn">Search</button>
</form>

{% if messages %}
    <ul>
        {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<h3>Matching Students</h3>
<form method="post">
    {% csrf_token %}
    <ul>
        {% for student in found_students %}
            <li>
                {{ student.username }}
                <button type="submit" name="username" value="{{ student.username }}" class="btn btn-join">Add</button>
            </li>
        {% endfor %}
    </ul>
    {% if not found_students %}
        <p>No matching students found.</p>
    {% endif %}
</form>

<h3>Currently Enrolled Students</h3>
{% if class.students.exists %}
    <ul>
        {% for student in class.students.all %}
            <li>{{ student.username }}</li>
        {% endfor %}
    </ul>
{% else %}
    <p>No students are currently enrolled in this class.</p>
{% endif %}
{% endblock %}
